<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" http-equiv="Content-Security-Policy" content="script-src 'self' 'sha256-In6B8teKZQll5heMl9bS7CESTbGvuAt3VVV86BUQBDk='"/>
    <title><%= lang('app.title') %></title>
    <script src="./assets/js/scripts/uicore.js"></script>
    <script src="./assets/js/scripts/uibinder.js"></script>
    <link type="text/css" rel="stylesheet" href="./assets/css/launcher.css">

    <style>
        body {
            transition: background-image 1s ease;
            background-image: url('data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD//gA+Q1JFQVRPUjogZ2QtanBlZyB2MS4wICh1c2luZyBJSkcgSlBFRyB2ODApLCBkZWZhdWx0IHF1YWxpdHkK/9sAQwAIBgYHBgUIBwcHCQkICgwUDQwLCwwZEhMPFB0aHx4dGhwcICQuJyAiLCMcHCg3KSwwMTQ0NB8nOT04MjwuMzQy/9sAQwEJCQkMCwwYDQ0YMiEcITIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIy/8AAEQgAPwBwAwEiAAIRAQMRAf/EAB8AAAEFAQEBAQEBAAAAAAAAAAABAgMEBQYHCAkKC//EALUQAAIBAwMCBAMFBQQEAAABfQECAwAEEQUSITFBBhNRYQcicRQygZGhCCNCscEVUtHwJDNicoIJChYXGBkaJSYnKCkqNDU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6g4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2drh4uPk5ebn6Onq8fLz9PX29/j5+v/EAB8BAAMBAQEBAQEBAQEAAAAAAAABAgMEBQYHCAkKC//EALURAAIBAgQEAwQHBQQEAAECdwABAgMRBAUhMQYSQVEHYXETIjKBCBRCkaGxwQkjM1LwFWJy0QoWJDThJfEXGBkaJicoKSo1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoKDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uLj5OXm5+jp6vLz9PX29/j5+v/aAAwDAQACEQMRAD8A8VooopDCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKAP/9k=');
            background-size: cover;
            -webkit-user-select: none;
        }

        #main {
            display: none;
            height: calc(100% - 22px);
            background: linear-gradient(to top, rgba(0, 0, 0, 0.75) 0%, rgba(0, 0, 0, 0) 100%);
            width: 100%;
            position: absolute;
            z-index: 10;
        }

        #main[overlay] {
            filter: blur(3px) contrast(0.9) brightness(1.0);
        }

        /* ------------------------------------------------------------
           LOADER "Windows-like" (ring de points) - 5 points
           Basé sur une recréation Windows 10 (rotation + opacité),
           adaptée à 5 points + intégrée sous ton logo.
           ------------------------------------------------------------ */

        /* On écrase au besoin les styles éventuels de launcher.css */
        #loadingContainer #loadSpinnerContainer{
            display: flex !important;
            flex-direction: column !important;
            align-items: center !important;
            justify-content: center !important;
            gap: 0 !important;
            position: relative !important;
        }

        #loadingContainer #loadCenterImage{
            display: block !important;
            position: static !important;
            transform: none !important;
        }

        #loadingContainer #winLoader{
            /* taille/placement conservés */
            --spinner-size: 52px;
            --dot-size: 7px;
            --duration: 5s;     /* ressemble au rythme Windows (pas “trop rapide”) */
            --gap: 0.22s;       /* espacement temporel entre dots */
            --radius: calc((var(--spinner-size) - var(--dot-size)) / 2);

            position: relative !important;
            width: var(--spinner-size);
            height: var(--spinner-size);
            margin-top: 46px !important; /* distance sous le logo */
            pointer-events: none;
        }

        /* Chaque “slot” (dot) couvre le cercle entier et tourne */
        #loadingContainer #winLoader .winDot{
            position: absolute;
            inset: 0;
            opacity: 0;

            /* easing Windows-like (accélère puis ralentit) */
            animation:
              winR var(--duration) infinite cubic-bezier(0.15, 0.55, 0.85, 0.45),
              winO var(--duration) infinite step-end;

            animation-fill-mode: both;
            will-change: transform, opacity;
        }

        /* Le point lui-même est placé sur le rayon */
        #loadingContainer #winLoader .winDot::after{
            content: "";
            position: absolute;
            left: 50%;
            top: 50%;
            width: var(--dot-size);
            height: var(--dot-size);
            border-radius: 999px;
            background: rgba(255,255,255,0.92);

            /* centre -> puis descend de 'radius' (donc sur le cercle) */
            transform: translate(-50%, calc(-50% + var(--radius)));
        }

        /* 5 points “en poursuite” : delays négatifs (démarre direct, spacing stable) */
        #loadingContainer #winLoader .winDot:nth-child(1){ animation-delay:  0s; }
        #loadingContainer #winLoader .winDot:nth-child(2){ animation-delay: calc(-1 * var(--gap) * 1); }
        #loadingContainer #winLoader .winDot:nth-child(3){ animation-delay: calc(-1 * var(--gap) * 2); }
        #loadingContainer #winLoader .winDot:nth-child(4){ animation-delay: calc(-1 * var(--gap) * 3); }
        #loadingContainer #winLoader .winDot:nth-child(5){ animation-delay: calc(-1 * var(--gap) * 4); }

        /* Rotation “Windows-like” : 2 tours avec pause en fin de cycle */
        @keyframes winR {
            0%   { transform: rotate(-90deg); }
            35%  { transform: rotate(270deg); }
            70%  { transform: rotate(630deg); }
            100% { transform: rotate(630deg); }
        }

        /* Fenêtre d’opacité (les points “s’éteignent” après un certain temps) */
        @keyframes winO {
            0%   { opacity: 1; }
            70%  { opacity: 0; }
        }

        @media (prefers-reduced-motion: reduce) {
            #loadingContainer #winLoader .winDot{
                animation: none;
                opacity: 0.9;
            }
        }
    </style>
</head>

<body bkid="<%=bkid%>">
    <%- include('frame') %>

    <div id="main">
        <%- include('welcome') %>
        <%- include('login') %>
        <%- include('waiting') %>
        <%- include('loginOptions') %>
        <%- include('settings') %>
        <%- include('landing') %>
    </div>

    <%- include('overlay') %>

    <div id="loadingContainer">
        <div id="loadingContent">
            <div id="loadSpinnerContainer">

                <!-- Logo -->
                <img id="loadCenterImage" src="assets/images/LoadingSeal.png">

                <!-- Loader Windows-like EN DESSOUS (5 points) -->
                <div id="winLoader" role="status" aria-label="Loading">
                    <div class="winDot"></div>
                    <div class="winDot"></div>
                    <div class="winDot"></div>
                    <div class="winDot"></div>
                    <div class="winDot"></div>
                </div>

            </div>
        </div>
    </div>
</body>
</html>
